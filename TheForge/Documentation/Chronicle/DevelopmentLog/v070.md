## v0.7.0 — UI Improvements (2025-01-02)

### Description
Enhanced Dashboard UI with module details panel, log controls, and refresh functionality to improve usability and provide better visibility into module state.

### What It Does
- Adds `pnlModuleDetails` panel to right side of UI:
  - Shows FileName, DisplayName, TypeName, LastLoadedTime, IsLoaded
  - Uses TableLayoutPanel for deterministic layout
  - Updates automatically when module is selected
  - Read-only TextBoxes for all fields
- Adds "Clear Log" button (btnClearLog) to log panel:
  - Clears txtLogOutput content
  - Logs the clear action
  - Updates StatusLabel
- Adds "Refresh Modules" button (btnRefreshModules) to module list panel:
  - Re-discovers modules without restarting Dashboard
  - Preserves cached metadata and loaded state
  - Maintains previous selection if still valid
  - Logs refresh action
- Implements comprehensive UI state management:
  - Disables Run button when module is already loaded
  - Disables Unload button when module is not loaded
  - Disables both buttons when no module is selected
  - Shows module load status in StatusLabel ("Loaded" / "Not Loaded")
  - Updates all UI elements after state changes

### Issues Encountered

#### Issue 1: TableLayoutPanel Row Sizing
**Problem:** Initial TableLayoutPanel layout didn't size rows appropriately for labels and TextBoxes.

**Root Cause:** Not setting explicit Heights on controls within TableLayoutPanel cells caused inconsistent spacing.

**Resolution:** Set explicit Height properties on all labels (20px) and TextBoxes (23px standard, 60px for multiline):
```vb
lblFileName.Height = 20
lblFileName.Dock = DockStyle.Fill

txtFileName.Height = 23
txtFileName.Dock = DockStyle.Fill
```

#### Issue 2: Module Details Panel Visibility
**Problem:** Module details needed to be clearly separated from test area but not interfere with existing layout.

**Root Cause:** Adding a new panel to the right side required careful control ordering to maintain splitter behavior.

**Resolution:** Added splitterVerticalRight and pnlModuleDetails in correct order:
```vb
Me.Controls.Add(pnlTestArea)           ' Fill
Me.Controls.Add(splitterVerticalRight) ' Right splitter
Me.Controls.Add(pnlModuleDetails)      ' Right panel
Me.Controls.Add(splitterHorizontal)    ' Bottom splitter
Me.Controls.Add(pnlLogOutput)          ' Bottom panel
Me.Controls.Add(splitterVertical)      ' Left splitter
Me.Controls.Add(pnlModuleList)         ' Left panel
Me.Controls.Add(MainStatusStrip)       ' Bottom status
```

#### Issue 3: Button State Management Logic
**Problem:** Needed to ensure Run and Unload buttons are never both enabled simultaneously.

**Root Cause:** Module can only be in one state at a time (loaded or not loaded), so button states must be mutually exclusive.

**Resolution:** Implemented clear state-based logic in HandleModuleSelection:
```vb
If moduleMetadata.IsLoaded Then
    btnRunModule.Enabled = False
    btnUnloadModule.Enabled = True
Else
    btnRunModule.Enabled = True
    btnUnloadModule.Enabled = False
End If
```

#### Issue 4: Refresh Preserving Selection
**Problem:** Refreshing modules cleared the selection, requiring user to reselect their module.

**Root Cause:** LoadAvailableModules() cleared lstModules.Items without preserving selection index.

**Resolution:** Captured selection index before refresh and restored it afterward:
```vb
Dim previousSelection As Integer = lstModules.SelectedIndex
LoadAvailableModules()

If previousSelection >= 0 AndAlso previousSelection < lstModules.Items.Count Then
    lstModules.SelectedIndex = previousSelection
End If
```

#### Issue 5: Nullable DateTime Display
**Problem:** LastLoadedTime is `DateTime?` and needed appropriate display for null values.

**Root Cause:** Cannot directly convert nullable DateTime to string without checking for null.

**Resolution:** Used null-conditional formatting:
```vb
txtLastLoadedTime.Text = If(moduleMetadata.LastLoadedTime.HasValue, _
    moduleMetadata.LastLoadedTime.Value.ToString("yyyy-MM-dd HH:mm:ss"), _
    "Never")
```

### Development Patterns & Lessons Learned

7. **Complex Layout Management**
   - Use TableLayoutPanel for multi-row detail displays
   - Set explicit Heights on controls within layout panels
   - Add panels and splitters in correct order for multi-panel layouts
   - Test panel resizing behavior with splitters

8. **Selection Preservation**
   - Capture selection state before refresh operations
   - Restore selection if still valid after data reload
   - Improves user experience during dynamic updates

### Build Status
? **Build Status:** Success  
? **Runtime Status:** Runs  
? **Notes:** UI improvements complete
